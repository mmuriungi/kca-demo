page 52087 "Timetable Header"
{
    ApplicationArea = All;
    Caption = 'Timetable Header';
    PageType = Card;
    SourceTable = "Timetable Header";
    PromotedActionCategories = 'New,Process,Reports,Constraints';

    layout
    {
        area(Content)
        {
            group(General)
            {
                Caption = 'General';

                field("Academic Year"; Rec."Academic Year")
                {
                    ToolTip = 'Specifies the value of the Academic Year field.', Comment = '%';
                }
                field(Semester; Rec.Semester)
                {
                    ToolTip = 'Specifies the value of the Semester field.', Comment = '%';
                }
                field("Generated By"; Rec."Generated By")
                {
                    ToolTip = 'Specifies the value of the Generated By field.', Comment = '%';
                }
                field("Exam Type"; Rec."Exam Type")
                {
                    ToolTip = 'Specifies the value of the Exam Type field.', Comment = '%';
                }
            }
            part(timetableEntry; "Timetable Entry")
            {
                Visible = Rec."Type" <> Rec."Type"::Exam;
                ApplicationArea = All;
                Caption = 'Timetable Entry';
                SubPageLink = Semester = field(Semester);
            }
            part(examTimetableEntry; "Exam Timetable Entry")
            {
                Visible = Rec."Type" = Rec."Type"::Exam;
                SubPageLink = Semester = field(Semester), "Exam Type" = field("Exam Type");
                ApplicationArea = All;
                Caption = 'Exam Timetable Entry';
            }
        }
    }
    actions
    {
        area(Navigation)
        {
            action("Lecturer Timetable Constraints")
            {
                ApplicationArea = All;
                Caption = 'Lecturer Timetable Constraints';
                RunObject = Page "Lecturer Timetable Constraints";
                RunPageLink = Semester = field(Semester);
                Visible = rec.Type = rec.Type::Class;
                Image = ConditionalBreakpoint;
                Promoted = true;
                PromotedCategory = Category4;
            }
            action("Online Preferences")
            {
                ApplicationArea = All;
                Caption = 'Online Preferences';
                RunObject = Page "Online Preferences";
                Visible = rec.Type = rec.Type::Class;
                Image = ConditionalBreakpoint;
                Promoted = true;
                PromotedCategory = Category4;
            }
        }
        area(Processing)
        {
            action(GenerateTimetable)
            {
                ApplicationArea = All;
                Caption = 'Generate Timetable';
                Promoted = true;
                PromotedCategory = Process;
                Visible = rec.Type = rec.Type::Class;
                PromotedIsBig = true;
                Image = GetLines;
                trigger OnAction()
                var
                    TtCu: codeunit "Timetable Management";
                begin
                    TtCu.GenerateTimetable(Rec."Academic Year", Rec.Semester);
                end;
            }
            action(GenerateExamTimetable)
            {
                ApplicationArea = All;
                Caption = 'Generate Exam Timetable';
                Promoted = true;
                PromotedCategory = Process;
                Visible = (rec.Type = rec.Type::Exam) and (rec."Exam Type" = rec."Exam Type"::Regular);
                PromotedIsBig = true;
                Image = GetLines;
                trigger OnAction()
                var
                    TtCu: codeunit "Timetable Management";
                begin
                    TtCu.GenerateExamTimetable(Rec.Semester);
                end;
            }
            action(GenerateSupplementaryExamTimetable)
            {
                ApplicationArea = All;
                Caption = 'Generate Supplementary Exam Timetable';
                Promoted = true;
                PromotedCategory = Process;
                Visible = (rec.Type = rec.Type::Exam) and (rec."Exam Type" = rec."Exam Type"::Supplementary);
                PromotedIsBig = true;
                Image = GetLines;
                trigger OnAction()
                var
                    TtCu: codeunit "Timetable Management";
                begin
                    TtCu.GenerateSuppTimetable(Rec.Semester);
                end;
            }
            action(GenerateExamTimeSlots)
            {
                ApplicationArea = All;
                Caption = 'Generate Exam Time Slots';
                Promoted = true;
                PromotedCategory = Process;
                PromotedIsBig = true;
                Visible = (rec.Type = rec.Type::Exam) and (rec."Exam Type" = rec."Exam Type"::Regular);
                Image = GetLines;
                trigger OnAction()
                var
                    TtCu: codeunit "Timetable Management";
                begin
                    TtCu.GenerateExamTimeSlots(Rec.Semester);
                end;
            }
            action(GenerateSupplementaryExamTimeSlots)
            {
                ApplicationArea = All;
                Caption = 'Generate Supplementary Exam Time Slots';
                Promoted = true;
                PromotedCategory = Process;
                PromotedIsBig = true;
                Visible = (rec.Type = rec.Type::Exam) and (rec."Exam Type" = rec."Exam Type"::Supplementary);
                Image = GetLines;
                trigger OnAction()
                var
                    TtCu: codeunit "Timetable Management";
                begin
                    TtCu.GenerateSuppExamTimeSlots(Rec.Semester);
                end;
            }
            action("Timetable Report")
            {
                ApplicationArea = All;
                Caption = 'Timetable Report';
                Promoted = true;
                PromotedCategory = Process;
                PromotedIsBig = true;
                Image = GetLines;
                Visible = rec.Type = rec.Type::Class;
                trigger OnAction()
                var
                    THeader: Record "Timetable Header";
                begin
                    THeader.Reset();
                    THeader.SetRange(Semester, Rec.Semester);
                    if THeader.FindFirst() then
                        Report.Run(Report::"Class Timetable Report", TRUE, FALSE, THeader);
                end;
            }
            action("Exam Timetable Report")
            {
                ApplicationArea = All;
                Caption = 'Exam Timetable Report';
                Promoted = true;
                PromotedCategory = Process;
                PromotedIsBig = true;
                Image = GetLines;
                Visible = rec.Type = rec.Type::Exam;
                trigger OnAction()
                var
                    THeader: Record "Timetable Header";
                begin
                    THeader.Reset();
                    THeader.SetRange(Semester, Rec.Semester);
                    if THeader.FindFirst() then
                        Report.Run(Report::"Exam Timetable", TRUE, FALSE, THeader);
                end;
            }
        }
    }
}
